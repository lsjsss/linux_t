1.列出当前主机已安装的所有RPM软件
rpm -qa | wc -l

2.查看firefox软件包的安装清单
rpm -ql firefox

3.查看firefox软件包的用途
rpm -qi firefox

4.查询光盘中的lynx软件包的用途，安装清单
rpm -pi firefox

5.利用rpm安装vsftpd这个软件包
rpm -ihv /mnt/Packages/vsftpd-3.0.2-22.el7.x86_64.rpm
rpm -q vsftpd

6.删除vim、vi、hostname命令程序
which vim vi hostname
rm- rf /usr/bin/vim /usr/bin/hostname /

7.修复vim、vi、hostname
rpm -ivh --force /mnt/Packages/vim-enhanced-7.4.160-4.el7.x86_64.rpm
rpm -qf /usr/bin/vim

8.安装bind-chroot包，体验依赖关系
rpm -ivh --force /mnt/Packages/bind-9.9.4-61.el7.x86_64.rpm

9.卸载vsftpd软件
rpm -e vsftpd
rpm -q vsftpd



yum练习
yum：自动解决依赖关系
1.将光盘文件挂载到/mnt目录下，查看/mnt下内容
mount /dev/cdrom /mnt
ls /mnt

2.搭建本地yum仓库
＃vim /etc/yum.repos.d/mnt.repo

[mnt] 			# 源名称
name=Centos7.5		# 操作系统版本
baseurl=file:///mnt		# 包路径，光盘挂载路径，要与挂在路径相同
enabled=1
gpgcheck=0		

＃ls /etc/yum.repos.d/
＃mkdir /etc/yum.repos.d/bind
＃mv /etc/yum.repos.d/bind
＃mv /etc/yum.repos.d/CentOS-* /etc/yum.repos.d/bind
＃ls /etc/yum.repos.d/
＃yum repolist	验证包


yum命令工具
yum list firefox  #查看软件列表

yum search ftp	#查找包含ftp和ftp相关的包
yum info firefox #查看firefox软件的描述信息
yum probides /etc/passwd	#查看/etc/passwd文件是由哪个软件产生的


安装/卸载软件包
yum [-y] 指令 [软件名]
yum [-y] install 安装指定软件包 类似于rpm -i
yum [-y] remove 卸载指定软件包

yum install https 安装https软件包
yum install -y gcc 自动安装



清空本地yum缓存
yum clean all


周期任务
cron任务
用途：按照设置的时间间隔为用户反复执行某一项固定的系统任务
软件包：cronie、crontabs
*系统服务：crond
*日志文件：/var/log/cron
tail /var/log/cron    # 了解cron执行消息
crontab -e -u root 为root用户添加日志文件
crontab -r 清空当前用户计划任务


> 编写crontab任务记录
> /etc/crontab文件：
> 任务命令行（绝对路径）：  分时日月周
> *：匹配范围内任意时间 例如 * * * * * 
> ,：分隔多个不连续的时间点
> -：指定连续时间范围
> /n：指定时间频率，每n...


> 案例1：添加用户帐号
1. 创建一个名为tedu01的用户帐号 
```shell
useradd tedu01
grep tedu01 /etc/passwd
id tedu01
```

2. 检查/etc/passwd文件的最后一行
```shell
tail -1 /etc/passwd
```

3. 检查/home新增的宿主目录
```shell
ls /home/
```

4. 新建用户tedu02,宿主目录位于/opt/tedu02
```shell
useradd -d /opt/tedu02 tedu02
grep tedu02 /etc/passwd
```

5. 新建系统账号system01，将UID设为1234，登录shell设为/sbin/nologin
```shell
useradd -u 1234 -s /sbin/nologin system0
grep system01 /etc/passwd
```

6. 新建用户admin，附加组设为adm，root
```shell
useradd -G adm,root admin
id admin
```




更改用户tedu 01密码（root用户）
```shell
passwd tedu01
```
修改当前用户密码
```shell
passwd
```

直接为用户tedu02设置密码123（非交互式）
```shell
echo 123 | passwd --stdin tedu02
```




> 案例2：设置用户密码
1. 为用户tedu01设置一个密码：123456
```shell
echo 123456 | passwd --stdin tedu01
```

2. 过滤/etc/shadow文件中包含tedu01的内容
```shell
grep tedu01 /etc/shadow
```

3. 为用户system01设置密码，并测试是否能够登录
```shell
echo a | passwd --stdin system01
```
无法登陆

4. 非交互式给用户tedu02设置密码123456
```shell
echo 123456 | passwd --stdin tedu02
```

5. 交互式给用户admin设置密码redhat
```shell
passwd admin
```
redhat


> 删除用户
`userdel 用户名`	删除用户（不删除用户的家目录）
`userdel -r 用户名`	删除用户及用户的家目录
```shell
userdel -r admin
```
删除用户的同时删除用户的家目录

---

> 案例1:指定yum软件源
– 将此配置为虚拟机默认软件仓库
```shell
rm -rf /var/run/yum.pid
yum repolist 
```

– 确认可用的仓库列表
```shell
rm -rf /etc/yum.repos.d/C*
ls /etc/yum.repos.d/
```

– 利用yum仓库安装httpd与vsftpd
```shell
vim /etc/yum.repos.d/mnt.repo
    [mnt]
    name=Centos
    baseurl=file:///dvd
    enabled=1
    gpgcheck=0
cat /etc/yum.repos.d/mnt.repo
mkdir /dvd
mount /dev/cdrom /dvd
yum install httpd
yum install vsftpd
```

– 利用rpm命令检测是否安装成功

```shell
rpm -q httpd
rpm -q vsftpd
```

> 案例2:查找并处理文件
 – 创建目录/root/findfiles/
```shell
mkdir /root/findfiles
ls /root/
```

 – 利用find查找所有用户 lisi 拥有的必须是文件,把它们拷贝到 /root/findfiles/ 文件夹中
```shell
find / -user lisi -a -type f
```

 – 利用find查找/boot目录下大于10M并且必须是文件，拷贝到/opt
```shell
find /boot -size +10M -type f -exec cp {} /opt/ \;
```

 – 将目录 /boot内容中以 vm 开头的数据, 复制到/boot/kernel目录下
```shell
find /boot -name "vm*" -exec cp {} /boot/kernel/ \;
```

 – 利用find查找/boot/ 目录下为快捷方式
```shell
find /boot -type l
```

 – 利用find查找/etc 目录下，以 tab 作为结尾的 必须是文件，将其拷贝到/opt/tab/文件夹下
```shell
find /etc -type "$tab" -type f -exec cp {} /opt/tab/ \;
```


> 案例3:查找并提取文件内容
1. 在文件 /usr/share/dict/words 中查找到所有包含字符串 seismic 的行,将输出信息,写入到/opt/nsd18.txt
```shell
grep "seismic" /usr/share/dict/words >> /optnsd18.txt
cat /optnsd18.txt
```

2. 查看内核版本，将显示结果重定向到/root/version.txt
```shell
uname -r > /root/version.txt
```


3. 查看红帽系统版本，将显示结果追加到/root/version.txt
```shell
cat /red hat-release > /root/version.txt
```


4. 查看主机名将显示结果追加到/root/version.txt
```shell
hostname > /root/version.txt
```


5. 将/etc/fstab文件中以UUID开头的信息，写入到/root/fstab.txt
```shell
grep ‘^UUID’ /etc/fstab > /root/fastab.txt
```


6. 提取/etc/passwd以bash结尾的行，将其信息写入/opt/pass.txt
```shell
grep ‘bash$’/etc/passwd  > /opt/pass.txt
```


7. 复制/etc/login.defs文件到当前目录下，改名为init.txt
```shell
cp /etc/login.defs ./init.txt
```


8. 提取init.txt文件里的有效配置（去除以#号开头，去除空行），保存为init2.txt
```shell
grep -v '^#' init.txt | grep -v '^$' > init2.txt
```



> 案例4:tar制作/释放归档压缩包（zcf、ztf、zxf、jcf、jtf、jxf、cf、tf）
  首先创建/root/boothome/与/root/usrsbin/目录
```shell

```

1. 备份/boot、/home这两个文件夹，保存为boothome.tar.gz文件
```shell

```

2. 查看boothome.tar.gz文件内包含哪些内容 
```shell

```

3. 将boothome.tar.gz释放到文件夹/root/boothome/下
```shell

```

    4）备份/usr/sbin目录，保存为usrsbin.tar.bz2文件
```shell

```

    5）查看usrsbin.tar.bz2文件内包含哪些内容
```shell

```

    6）将usrsbin.tar.bz2释放到/root/usrsbin/文件夹下
```shell

```

    7）创建一个名为 /root/backup.tar.bz2 的归档文件，其中包含 /usr/local 目录中的内容，tar 归档必须使用 bzip2 进行压缩
```shell

```


> 案例5：usermod修改用户
1. 新建一个用户nsd03，将宿主目录设为/opt/home03，并设置密码为redhat
```shell
useradd -d /opt/home03 nsd03
id nsd03
ls /opt
echo redhat | passwd --stdin nsd03
```

2. 将用户nsd03的宿主目录改为/home/nsd03
```shell

```

3. 将用户sys01的登录Shell改为/bin/bash
```shell

```


> 案例6：创建用户
1. 创建一个名为alex的用户，用户ID是 3456。密码是flectrag
```shell
useradd -u 3456 alex
echo 3456 | passwd --stdin alex
id alex
```


> 案例7：创建用户和组
1. 一个名为adminuser的组
```shell
groupadd adminuser
grep adminuser /etc/group
```

2. 一个名为natasha的用户，其属于adminuser，这个组是该用户的从属组
```shell
useradd natasha -G adminuser
id natasha
```

3. 一个名为harry的用户，属于adminuser，这个组是该用户的从属组
```shell
useradd harry -G adminuser
id harry
```

4. 一个名为sarah的用户，其在系统中没有可交互的shell，并且不是adminuser组的成员用户
```shell
useradd sarah -s /sbin/nologin
id sarah
```

5. natasha、harry、和sarah的密码都要设置为flectrag
```shell
echo flectrag | passwd --stdin natasha
echo flectrag | passwd --stdin harry
echo flectrag | passwd --stdin sarah
```

> 案例8：配置一个cron任务
1. 为用户 natasha 配置一个定时任务
```shell
su natasha
crontab -e
```

2. 每天在本地时间 23:30 执行
3. 需要完成的任务操作为 /bin/echo  hiya
```shell
30 23 * * * /bin/echo hiya
```

> 案例9：设置别名
1. 为root用户永久设置别名为hn=‘hostname’
```shell
su root
vim ~/.bashrc
alias hn='hostname'
```


2. 为所有用户设置别名为 qstat='/bin/ps -Ao pid,tt,user,fname,rsz' 
```shell
vim /etc/bashrc
qstat='/bin/ps -Ao pid,tt,user,fname,rsz'
```


